% This update script does not need v2 because it simulates the Schrodinger
% equation not influenced by the EM radiation (no phi or Jq involved).
% Also, all differences are central with repect to each other.

psim1 = psim0; psim0 = psi;

psi(2:Nx_qd-1,2:Ny_qd-1,2:Nz_qd-1) = psim1(2:Nx_qd-1,2:Ny_qd-1,2:Nz_qd-1) ...
                                + 1i*hbar*dt/me*((psim0(3:Nx_qd,2:Ny_qd-1,2:Nz_qd-1)-2*psim0(2:Nx_qd-1,2:Ny_qd-1,2:Nz_qd-1)+psim0(1:Nx_qd-2,2:Ny_qd-1,2:Nz_qd-1))/dx^2 ...
                                + (psim0(2:Nx_qd-1,3:Ny_qd,2:Nz_qd-1)-2*psim0(2:Nx_qd-1,2:Ny_qd-1,2:Nz_qd-1)+psim0(2:Nx_qd-1,1:Ny_qd-2,2:Nz_qd-1))/dy^2 ...
                                + (psim0(2:Nx_qd-1,2:Ny_qd-1,3:Nz_qd)-2*psim0(2:Nx_qd-1,2:Ny_qd-1,2:Nz_qd-1)+psim0(2:Nx_qd-1,2:Ny_qd-1,1:Nz_qd-2))/dz^2) ...
                                - 1i*2*V(2:Nx_qd-1,2:Ny_qd-1,2:Nz_qd-1)*dt/hbar.*psim0(2:Nx_qd-1,2:Ny_qd-1,2:Nz_qd-1);